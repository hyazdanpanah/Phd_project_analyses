---
title: "Ice Fishing Exposure in the Saguenay Fjord"
author: "Hediyeh Yazdanpanah"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: show
    highlight: pygments
    theme: yeti
    toc: TRUE
    toc_depth: 4
    toc_float:
      collapsed: TRUE
      smooth_scroll: TRUE
    df_print: paged
    fig_caption: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = TRUE,
  message = TRUE,
  error = TRUE,
  fig.width = 10,
  fig.height = 8
)

# SET WORKING DIRECTORY
knitr::opts_knit$set(root.dir = "/Users/hediyeh/Desktop/Phd_project_analyses/Chapter_1/Rmarkdown & Data/ice_fishing")

# Source shared functions (this will load all required packages)
#source("/Users/hediyeh/Desktop/Phd_project_analyses/Chapter_1/00_shared_functions.R")
#source("/Users/hediyeh/Desktop/Phd_project_analyses/Chapter_1/00_shared_functions_0.00025.R")
source("/Users/hediyeh/Desktop/Phd_project_analyses/Chapter_1/00_shered_functions_0.00005.R")

# Load ONLY the extra packages needed for THIS specific analysis
library(RColorBrewer)
library(viridis)
library(reshape2)
```

# Introduction

Winter recreational fishing, commonly known as ice fishing, represents a significant seasonal human activity in the Saguenay Fjord. The winter recreational groundfish fishery operates under DFO regulation from January to March annually, attracting thousands of participants to the frozen fjord surface (Gauthier et al., 2020). This intensive seasonal activity creates concentrated areas of human disturbance that may impact benthic communities through multiple pathways.

## Ice Fishing in the Saguenay Fjord

The Saguenay Fjord supports one of Canada's most concentrated ice fishing activities, with ephemeral ice fishing villages of up to 900 colorful cabins established on the fjord surface during winter months. Since 1995, DFO has coordinated a comprehensive monitoring program for the winter recreational fishery, providing long-term data on fishing effort and catch composition (Gauthier et al., 2020).

## Ice Fishing as a Human-Induced Stressor

**Direct Physical Disturbance**

Ice fishing activities create multiple forms of direct physical disturbance to benthic habitats. The establishment of fishing holes through the ice layer, placement of temporary structures, and concentrated human activity over discrete areas generate localized disturbance pressures. Fishing disturbance can alter marine habitats and ecosystems, with the pressure/state relationship providing a basis for implementing management measures that minimize impacts (Sciberras et al., 2017).

**Localized Impact Zones and Threshold Effects**

The Saguenay Fjord supports multiple fishing villages distributed throughout the fjord system during the winter season. While up to 900 ice fishing cabins operate across the fjord, these structures are organized into discrete fishing villages, each typically containing 50-150 cabins concentrated in preferred fishing locations (Gauthier et al., 2020). This spatial organization creates multiple localized impact zones rather than a single concentrated disturbance area.

Research on recreational fishing impacts demonstrates that even moderate levels of fishing activity can create measurable effects on benthic communities, with the intensity of impact correlating strongly with the concentration of fishing effort in discrete areas (Radford et al., 2019). In ice fishing contexts, localized impacts occur through several mechanisms: concentrated organic loading from fish processing waste, repeated drilling of fishing holes through ice, placement of temporary structures, and cumulative disturbance from sustained human activity over discrete areas during the 8-week fishing season.

**Cumulative Impact Assessment**

While individual ice fishing activities generate relatively modest environmental impacts, the cumulative effect of multiple fishing villages operating simultaneously throughout the fjord creates a spatially heterogeneous disturbance pattern. Each fishing village represents a localized zone of concentrated activity where cumulative impacts may significantly exceed those of dispersed recreational fishing (Radford et al., 2019).

The temporal concentration of ice fishing activities during the winter months means that disturbance occurs when benthic communities may be less resilient due to reduced metabolic activity in cold-water conditions (Galbraith & Winkler, 2012). Recovery processes must occur during the brief ice-free season, potentially limiting the ability of benthic communities to fully recover before the subsequent winter fishing season.

## Methodology Overview

This analysis utilized DFO data on cabin numbers and locations from the regulated winter recreational groundfish fishery to quantify ice fishing pressure. The exposure model employs a **Level II decay function** (a = -0.1) to represent the spatial extent of ice fishing impacts radiating from cabin locations, with **proportional weighting** based on cabin density at each site.

# Data Loading

## Base Data

```{r load-base-data}
# Load bathymetry using shared function
bathy_path <- "/Users/hediyeh/Desktop/Phd_project_analyses/Chapter_1/Rmarkdown & Data/ice_fishing/bathy.tif"
bathy_data <- load_bathymetry(bathy_path = bathy_path)

bathy_200 <- bathy_data$bathy_200
water_mask <- bathy_data$water_mask
water_sf <- bathy_data$water_sf
```

## Ice Fishing Station Data

```{r load-ice-fishing-data}
# Load ice fishing station data
ice_fishing_path <- "/Users/hediyeh/Desktop/Phd_project_analyses/Chapter_1/Rmarkdown & Data/ice_fishing/ice fishing saguenay_2018.shp"
ice_fishing <- st_read(ice_fishing_path)

# Transform to target CRS
ice_fishing_sf <- st_transform(ice_fishing, crs = target_crs)

# Adjust station locations to nearest valid bathymetry cell
for (i in 1:nrow(ice_fishing_sf)) {
  st_geometry(ice_fishing_sf[i,]) <- nearest_valid_cell(
    st_coordinates(ice_fishing_sf[i,]),
    bathy_200
  ) %>%
    st_point() %>%
    st_sfc() %>%
    st_set_crs(target_crs)
}
```

## Cabin Distribution Analysis

```{r cabin-analysis}
# Calculate cabin proportions
total_cabins <- sum(ice_fishing_sf$cabin_2018)
ice_fishing_sf$cabin_prop <- ice_fishing_sf$cabin_2018 / total_cabins

# Create summary table
cabin_summary <- data.frame(
  Station = ice_fishing_sf$site,
  Cabins = ice_fishing_sf$cabin_2018,
  Proportion = ice_fishing_sf$cabin_prop,
  Percentage = round(ice_fishing_sf$cabin_prop * 100, 1)
)
cabin_summary <- cabin_summary[order(-cabin_summary$Cabins), ]

print(cabin_summary, row.names = FALSE)
```

# Grid and Transition Setup

```{r setup-grid-transition}
# Create full study area grid (for proper normalization context)
bbox_utm <- list(rbind(c(xmin, ymin), c(xmax, ymin), 
                       c(xmax, ymax), c(xmin, ymax), c(xmin, ymin))) %>%
  st_polygon() %>%
  st_sfc(crs = target_crs)

grid_res <- 200
grid_points_sf <- st_make_grid(bbox_utm,
                               cellsize = grid_res,
                               what = "centers") %>%
  st_sf()

grid_polygons_sf <- st_make_grid(bbox_utm,
                                 cellsize = grid_res,
                                 what = "polygons") %>%
  st_sf()

# Create transition layer using shared function
tr_bathy <- create_transition_layer(bathy_200)

# Create template raster using shared function
template_raster <- create_template_raster(bathy_200)
```

# Calculate Station-Specific Exposures

```{r calculate-exposures}
# Set decay type
decay_type <- "II"

# Create separate objects for each station
ice_LAB <- ice_fishing_sf[ice_fishing_sf$site == "L'Anse à Benjamin", ]
ice_GB  <- ice_fishing_sf[ice_fishing_sf$site == "Grand-Baie", ]
ice_SF  <- ice_fishing_sf[ice_fishing_sf$site == "Saint-Fulgence", ]
ice_ASJ <- ice_fishing_sf[ice_fishing_sf$site == "L'Anse-Saint-Jean", ]
ice_RE  <- ice_fishing_sf[ice_fishing_sf$site == "Rivière Éternité", ]
ice_SFO <- ice_fishing_sf[ice_fishing_sf$site == "Saint-Félix-d'Otis", ]
ice_SRN <- ice_fishing_sf[ice_fishing_sf$site == "Saint-Rose-du-Nord", ]

# Compute individual relative exposure fields using shared function
ice_LAB_exp <- RelativeExposure(ice_LAB, tr_bathy, decay_type, 
                                grid_points_sf, template_raster)

ice_GB_exp <- RelativeExposure(ice_GB, tr_bathy, decay_type, 
                               grid_points_sf, template_raster)

ice_SF_exp <- RelativeExposure(ice_SF, tr_bathy, decay_type, 
                               grid_points_sf, template_raster)

ice_ASJ_exp <- RelativeExposure(ice_ASJ, tr_bathy, decay_type, 
                                grid_points_sf, template_raster)

ice_RE_exp <- RelativeExposure(ice_RE, tr_bathy, decay_type, 
                               grid_points_sf, template_raster)

ice_SFO_exp <- RelativeExposure(ice_SFO, tr_bathy, decay_type, 
                                grid_points_sf, template_raster)

ice_SRN_exp <- RelativeExposure(ice_SRN, tr_bathy, decay_type, 
                                grid_points_sf, template_raster)

# Extract scaling factors
s_ice_LAB <- ice_fishing_sf$cabin_prop[ice_fishing_sf$site == "L'Anse à Benjamin"]
s_ice_GB  <- ice_fishing_sf$cabin_prop[ice_fishing_sf$site == "Grand-Baie"]
s_ice_SF  <- ice_fishing_sf$cabin_prop[ice_fishing_sf$site == "Saint-Fulgence"]
s_ice_ASJ <- ice_fishing_sf$cabin_prop[ice_fishing_sf$site == "L'Anse-Saint-Jean"]
s_ice_RE  <- ice_fishing_sf$cabin_prop[ice_fishing_sf$site == "Rivière Éternité"]
s_ice_SFO <- ice_fishing_sf$cabin_prop[ice_fishing_sf$site == "Saint-Félix-d'Otis"]
s_ice_SRN <- ice_fishing_sf$cabin_prop[ice_fishing_sf$site == "Saint-Rose-du-Nord"]
```

# Combine Weighted Exposures

```{r combine-exposures}
# Combine individual exposure values using proportional weights
ice_fishing_exp <- ice_LAB_exp * s_ice_LAB +
                   ice_GB_exp * s_ice_GB +
                   ice_SF_exp * s_ice_SF +
                   ice_ASJ_exp * s_ice_ASJ +
                   ice_RE_exp * s_ice_RE +
                   ice_SFO_exp * s_ice_SFO +
                   ice_SRN_exp * s_ice_SRN

# Apply water mask
ice_fishing_exp[is.na(bathy_200)] <- NA

# Normalize to [0,1] range
ice_fishing_exp_II <- ice_fishing_exp / max(values(ice_fishing_exp), na.rm = TRUE)
```

# Results Visualization

## Ice Fishing Exposure Map

```{r plot-exposure, fig.cap="Ice fishing exposure weighted by cabin density with Level II decay"}
#png("ice_fidhing_0.00005.png")
plot_exposure(ice_fishing_exp_II,
              "Ice Fishing Exposure - Cabin-Weighted (Level II)",
              xmin, xmax, ymin, ymax)
#dev.off()
```

## Stations and Exposure Overlay

```{r plot-overlay, fig.cap="Ice fishing stations overlaid on exposure map"}
plot(ice_fishing_exp_II,
     main = "Ice Fishing Stations and Exposure (2018)",
     xlab = "Easting (UTM Zone 19N)",
     ylab = "Northing (UTM Zone 19N)",
     xlim = c(xmin, xmax),
     ylim = c(ymin, ymax),
     axes = TRUE)

# Add station points sized by cabin count
coords <- st_coordinates(ice_fishing_sf)
cabin_sizes <- ice_fishing_sf$cabin_2018 / max(ice_fishing_sf$cabin_2018) * 3 + 0.5

points(coords[, 1], coords[, 2],
       pch = 21,
       cex = cabin_sizes,
       bg = "yellow",
       col = "red",
       lwd = 2)

legend("topright",
       legend = c("Major Stations (>300 cabins)",
                  "Moderate Stations (100-300 cabins)",
                  "Minor Stations (<100 cabins)"),
       pch = 21,
       pt.cex = c(3, 2, 1),
       pt.bg = "yellow",
       col = "red",
       cex = 0.8,
       bg = "white")
```

## Cabin Distribution by Station

```{r plot-cabins, fig.cap="Distribution of ice fishing cabins across stations in 2018"}
par(mar = c(7, 5, 4, 2) + 0.1)
bp <- barplot(
  cabin_summary$Cabins,
  names.arg = cabin_summary$Station,
  col = "steelblue",
  main = "Ice Fishing Cabins by Station (2018)",
  ylab = "Number of Cabins",
  xlab = "",
  ylim = c(0, max(cabin_summary$Cabins) * 1.15),
  las = 2,
  cex.names = 0.8
)

text(x = bp,
     y = cabin_summary$Cabins + max(cabin_summary$Cabins) * 0.03,
     labels = cabin_summary$Cabins,
     cex = 0.9)

text(x = bp,
     y = cabin_summary$Cabins - max(cabin_summary$Cabins) * 0.06,
     labels = paste0("(", cabin_summary$Percentage, "%)"),
     cex = 0.8,
     col = "white",
     font = 2)

mtext(paste("Total:", format(total_cabins, big.mark = ",")), 
      side = 3, line = 0.5, adj = 1, cex = 0.9, col = "gray40")
```


# Save Results

```{r save-results}
# Save exposure raster
writeRaster(ice_fishing_exp_II,
            filename = "ice_fishing_exposure.tif",
            overwrite = TRUE)

# Save station data
st_write(ice_fishing_sf,
         "ice_fishing_stations_2018.gpkg",
         delete_dsn = TRUE)

# Save workspace
save(ice_fishing_exp_II,
     ice_fishing_sf,
     cabin_summary,
     file = "ice_fishing_exposure.RData")
```

# Summary

This ice fishing exposure analysis successfully developed a cabin-density-weighted model to quantify seasonal recreational fishing impacts on the Saguenay Fjord benthic ecosystem:

**Key Features:**

- **DFO Monitoring Data**: Official 2018 cabin counts from regulated winter fishery
- **Proportional Weighting**: Exposure weighted by relative cabin density at each station
- **Station-Specific Modeling**: Individual exposure fields for 7 active fishing locations
- **Level II Decay**: Medium-range decay function (a = -0.1) for seasonal concentrated impacts
- **Full Grid Approach**: Normalization context includes entire study area for proper localization

**Results:**

- **`r nrow(ice_fishing_sf)`** ice fishing stations analyzed
- **`r total_cabins`** total cabins distributed across fjord (2018)
- **Dominant stations**: `r cabin_summary$Station[1]` (`r cabin_summary$Cabins[1]` cabins, `r cabin_summary$Percentage[1]`%) and `r cabin_summary$Station[2]` (`r cabin_summary$Cabins[2]` cabins, `r cabin_summary$Percentage[2]`%)
- **Spatial pattern**: Multiple localized impact zones with exposure decay from fishing villages

**Environmental Implications:**

Ice fishing exposure highlights areas where benthic communities experience seasonal cumulative impacts from:

- **Physical disturbance** through hole drilling and structure placement
- **Sediment disruption** affecting biogeochemical processes
- **Organic loading** from concentrated fishing waste
- **Community alterations** in repeatedly used locations over multiple seasons

**Temporal Context:**

Analysis of 2014-2018 cabin trends reveals:

- **22% decline** in total cabins from 2014 baseline (1554 cabins) to 2016 minimum (1212 cabins)
- **Partial recovery** to 1400 cabins by 2018 (-10% from 2014)
- **Spatial redistribution** of fishing effort among stations over time
- **Management implications** for monitoring seasonal impact intensity

# References

Gauthier, J., Ouellet, P., & Plourde, S. (2020). Caractérisation de la pêche récréative hivernale dans le fjord du Saguenay. *Pêches et Océans Canada*, Secrétariat canadien de consultation scientifique, Document de recherche 2017/022.

Galbraith, P. S., & Winkler, G. (2012). Physical oceanography of the Saguenay Fjord and the Saguenay-St. Lawrence Marine Park. In *Oceanography of Saguenay Fjord*.

Sciberras, M., Hiddink, J. G., Jennings, S., Szostek, C. L., Hughes, K. M., Kneafsey, B., ... & Kaiser, M. J. (2017). Response of benthic fauna to experimental bottom fishing: A global meta-analysis. *Fish and Fisheries*, 19(4), 698-715.

Radford, B. T., Babcock, R. C., Foster, S. D., & Thomson, D. P. (2019). Natural and fishing disturbance: Effects on benthic condition and trophic structure of fish communities. *Ecological Indicators*, 104, 379-388.

Zawadská, A., Machová, T., & Červený, D. (2024). Mapping recreational fishing ecosystem services and impacts. *Ecosystem Services*, 65, 101589.

Thrush, S. F., Hewitt, J. E., Cummings, V. J., Dayton, P. K., Cryer, M., Turner, S. J., ... & Williamson, R. B. (1998). Disturbance of the marine benthic habitat by commercial fishing: impacts at the scale of the fishery. *Ecological Applications*, 8(3), 866-879.

---

**Session Info:**

```{r session-info}
sessionInfo()
```
